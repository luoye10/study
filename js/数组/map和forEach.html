<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>map和forEach</title>
    </head>
    <body>
        <script>
            /**
             *
             *  map()
             *      创建一个新数组，由原数组的每个元素都调用一次提供的函数的返回值组成
             *
             *      参数
             *          callback
             *              生成新数组的函数，有三个参数
             *                  currentValue 数组中正在处理的当前元素
             *                  index  数组中正在处理的当前元素的索引
             *                  array  map方法调用的数组
             *          thisArg(可选)
             *              执行callback函数时被用作this的值
             *
             *      返回值
             *          一个新数组，每个元素都是回调函数的返回值
             *
             *  forEach()
             *      对数组的每个元素执行一次给定的函数
             *
             *      参数
             *          callback
             *              为数组中每个元素执行的函数，有三个参数
             *                  element 数组中正在处理的当前元素
             *                  index   数组中正在处理的当前元素的索引
             *                  array   forEach正在执行操作的数组
             *          thisArg(可选)
             *              执行callback函数时被用作this的值
             *
             *      返回值
             *          undefined
             *
             */
            let arr1 = [1, 2, 3, 4];
            result = arr1.map(n => n * n);
            arr1.forEach(item => {
                console.log(item * item);
            });
            console.log(result);

            let arr2 = [
                {
                    key: 1,
                    value: 10
                },
                {
                    key: 2,
                    value: 20
                },
                {
                    key: 3,
                    value: 30
                }
            ];
            arr2.forEach(item => {
                console.log(item);
            });
            res = arr2.map(({ key, value }) => {
                return { [key]: value };
            });
            console.log(res);

            let arr3 = [1, 2, 3, 4, 5];
            arr3.forEach((item, index) => {
                if (index < 3) {
                    console.log(item);
                }
            });
            rst = arr3.map((item, index) => {
                if (index < 3) {
                    return item;
                }
            });
            console.log(rst);

            // 在迭代期间修改数组
            let words = ['one', 'two', 'three', 'four'];
            words.forEach((item, index) => {
                console.log(item);
                if (index > 2) {
                    words.shift();
                }
            });
            console.log(words);

            // 扁平化数组
            function show(arr) {
                let newArr = [];
                arr.forEach(item => {
                    if (Array.isArray(item)) {
                        newArr.push(...show(item));
                    } else {
                        newArr.push(item);
                    }
                });
                return newArr;
            }
            let arrs = [1, 2, 3, [4, 5, [6, 7], 8]];
            console.log(show(arrs));

            /**
             *
             *  flat()
             *      按照一个可以指定的深度递归遍历数组，
             *      将所有元素和遍历到的子数组中的元素合并为一个新数组返回
             *
             *      参数
             *          depth(可选)
             *              指定要提取嵌套数组的结构深度，默认为 1
             *
             *      返回值
             *          一个包含数组与子数组中所有元素的新数组
             *
             */
            // infinity 可以展开任意深度的嵌套数组
            let nums = [11, 12, 22, [31, 33, [52, 55], 64], 78];
            newNums = nums.flat(Infinity);
            console.log(newNums);

            // flat() 会移除数组中的空项
            let num = [1, 2, , 3, 4, , 5];
            newNum = num.flat();
            console.log(num, newNum);
        </script>
    </body>
</html>
